<!DOCTYPE html>
    <html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title> Pago de impuestos: los planes de la DGI que buscan facilitarle al contribuyente y también marcarle la cancha</title>
        <style>
            body {
                max-width: 800px;
                margin: auto;
                padding: 5%;
            }
            .btnL {
                background: #d1d1d1;
                border-radius: 7px;
                padding: 18px;
                min-width: 100%;
                color: #000000;
                font-size: medium;
                min-height: 70px;
            }
            button {
                background-color: #d1d1d1;
                color: white;
                padding: 10px 20px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px;
            }
            button:disabled {
                background-color: #d1d1d1;
                cursor: not-available;
            }
            button:hover:not(:disabled) {
                background-color: #d1d1d1;
            }
            #voiceSelect {
                margin: 10px 0;
                padding: 5px;
            }
            .controls {
                margin: 10px 0;
            }

            #fullscreenButton {
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 10px;
                background-color: transparent;
                border: none;
                cursor: pointer;
                border-radius: 5px;
            }

            #fullscreenIcon {
                width: 24px;
                height: 24px;
            }

        </style>
    </head>
    <body>
        <button id="fullscreenButton">
        <svg id="fullscreenIcon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M5 5h5v5H5zM14 5h5v5h-5zM5 14h5v5H5zM14 14h5v5h-5z"/>
        </svg>
        </button>

        <div id="texto">
            <h1> Pago de impuestos: los planes de la DGI que buscan facilitarle al contribuyente y también marcarle la cancha</h1>
            <p>
El nuevo director de la Dirección General Impositiva (DGI), Gustavo González, repasó los principales ejes del plan estratégico para el quinquenio, que tiene como uno de sus elementos centrales “trabajar en las causas que producen los incumplimientos tributarios” para procurar “cambios de conducta que sean permanentes” en los contribuyentes. Además, explicó la idea de ampliar a futuro el uso de los formularios en línea con información precargada por la DGI para las declaraciones de impuestos. Esto para “facilitarle el trabajo al contribuyente” y también para “marcarle la cancha”.  El jerarca también habló sobre el cambio normativo que se plantea hacer para extender los plazos de financiación de adeudos para personas y empresas con voluntad de pago. Esto, con cuotas “asequibles” y mediante retenciones de ingresos previamente acordadas. Lo que sigue es un resumen de la entrevista que González concedió a El Observador.   ¿Cuáles son los principales ejes del plan estratégico para la gestión que está comenzando?Estamos ordenando todo en torno a la implementación de un modelo de gestión de cumplimiento. Eso, entre otras cosas, es explicitar en blanco y negro cómo vamos a trabajar, con qué orientaciones, cuáles van a ser los principales procesos que nos van a guiar. Las características de ese modelo es algo que en administraciones tributarias modernas existe hace 20 o 30 años y tiene que ver sobre todo, con trabajar en las causas que producen incumplimientos tributarios, y que son muy variadas. No es simplemente que la gente quiere evadir. De hecho, es una minoría la que quiere evadir. Tenés problemas de desconocimiento, de olvido, de que es difícil cumplir, de no conocer el procedimiento para cumplir, problemas de solvencia, entre otros. Y no pasa solo por hacer fiscalizaciones, cosa que es importante pero no es lo único. Cuando vos trabajas en todas las causas, el tornasol de acciones es mucho más variado. La comunicación, por ejemplo, es central, pero hay que trabajar en muchos planos. Entonces esa es la principal diferencia. Y hay otras que son derivaciones de eso, decisiones de dónde focalizar las acciones, de asignación de recursos, de cómo vas a utilizar la información y para qué. No solamente para seleccionar casos sino también para caracterizar a los contribuyentes, saber de qué manera te tenés que acercar a ellos. Por ejemplo, nosotros nos podemos anticipar a saber qué contribuyentes pueden tener más problemas de solvencia, pero al mismo tiempo, qué contribuyentes pueden, teniendo problemas de solvencia, tener voluntad de pago. Hay información que te permite caracterizar eso. Pero cuando preparás los dispositivos para saber cómo te vas a acercar a cada uno, necesitás primero haberlos perfilados. Saber que con este contribuyente es más probable que consiga mejores resultados si empiezo con una llamada telefónica simplemente o puedo ofrecerle planes de pago y en otro me tengo que acercar de otra manera, etcétera. Entonces el uso de la información tiene múltiples propósitos. Y asociado a lo mismo está el aprendizaje, que es como nuestra forma de incorporar inteligencia artificial. Cada vez que la DGI interviene, tiene una oportunidad de obtener información. Si yo te envío un mensaje y no respondés, eso es información, por ejemplo. Es algo que hay que incorporar a un proceso de toma de decisiones. Hay que hacerlo diseñando un proceso y estableciendo reglas.  Gustavo Gonzáles, director de la DGI.     Foto: Leonardo Carreño  Usted ha mencionado que está en los planes hacer innovaciones, por ejemplo, en las declaraciones de impuestos mediante los formularios en línea. ¿Cómo funciona hoy y hacia dónde quieren ir?Ahí hay dos cosas. Una es que los formularios que son web propiamente, que son los de IRPF, IASS y de IVA Servicios Personales son mucho más amigables. Esencialmente vos entrás a la web y ves tú declaración precargada, la podés editar ahí, cambiás lo que quieras, la enviás y ya está. El resto de las declaraciones funcionan por aplicaciones específicas que tenés que descargarte en tu computadora, abrir un formulario y cargarla. Tiene toda una secuencia de pasos, después grabás un archivo y ese archivo tenés que subirlo en los servicios en línea en DGI. Es más complicado, es como de una tecnología anterior. La idea es llevar todo hacia una plataforma como ocurre hoy en IRPF, por un tema de amigabilidad. Pero lo segundo, asociado a eso, es que el formulario no está en blanco, sino que tiene la información que nosotros tenemos disponible. Y ahí ha habido, a lo largo de estos años, un proceso de aprendizaje que ha hecho la DGI de ir perdiendo el temor a mostrar la información que tenemos. La postura que estamos manejando es: mostremos lo que tenemos y hagámoslo con sentido, con un propósito específico de facilitarle el trabajo al contribuyente y además también de marcarle la cancha, de decirle: ‘nosotros creemos que tu situación tributaria está por acá’. Eso supone no solamente mostrar la información que tenemos y sobre la cual tenemos evidencia perfecta, por ejemplo, a través de facturación electrónica. En servicios personales, por ejemplo, toda la información que un profesional o alguien que presta servicios fuera de relación de dependencia, siempre que facture, está. Sus compras también están. Y también están volcadas ahí, por ejemplo, el formulario de IVA para que vea qué compras son las que tiene disponibles para deducir. El día de mañana perfectamente podemos, además de eso, en el caso de alguien que no documente el 100% de sus operaciones, establecer una estimación bastante aproximada de cuál es su nivel de actividad, incluir otra información que vaya más allá de lo que tenemos estricta evidencia. No quiere decir que tenga que aceptar eso, se lo ponemos a consideración; ‘esto es lo que sabemos de vos’. A partir de ahí, como va a ser la única manera de enviar una declaración, necesariamente el contribuyente va a tener que pasar por eso. Es una herramienta de facilitación para que no tenga que preparar la declaración. Lo revisa, consulta, chequea, modifica todo lo que quiere y la envía. Una vez que la recibimos, la analizamos, obviamente mediante un procedimiento automático y hacemos una evaluación cualitativa de los cambios que realizó, chequeando si esos cambios son verosímiles o no y le devolvemos nuestra evaluación. Con eso lo que estamos haciendo es adelantando tiempos, porque hoy, gestiones de esas características que tengan más que ver con controlar la veracidad del contenido de una declaración a veces se hacen meses después. Aquí se lo estamos dando 24 horas después. La expectativa es que eso induzca algún cambio de comportamiento del contribuyente, que puede ser inmediato o no, pero nosotros ya estamos ahí estableciendo una comunicación. En rigor es el contribuyente el que sigue haciendo la liquidación porque así lo establece el Código Tributario, los impuestos son de autoliquidación. La diferencia es el punto de partida, porque el Código Tributario, que tiene sus años, en particular, en los artículos que refieren a la autoliquidación, estaba pensado para un mundo donde las administraciones tributarias no tenían la información que tienen hoy y donde procesarla a bajo costo era algo inviable. Esa información hoy la tenés, la podés procesar a un costo razonable, tiene sentido que la pongas a disposición. Es un tema de eficiencia económica, pero a nivel social. El costo que tiene para la DGI hacer eso es algo asequible y es un beneficio para los contribuyentes. Porque es tiempo que se ahorra y al mismo tiempo, estamos alcanzando un objetivo de gestión de cumplimiento que es: ‘este es el ámbito donde yo espero que vos te muevas’. Si vos te salís de ese cuadro, obviamente que eso me va a llamar la atención y te lo voy a hacer saber. Los pasos posteriores van a depender de cómo te comportes, de qué tan importante sea la situación que se presente, etcétera. ¿Cuándo se empezaría a aplicar eso?  Todavía no está definido, pero seguramente las primeras innovaciones estén en los impuestos que ya tienen declaraciones web, que son IRPF, IASS e IVA Servicios Personales. Lo que sí tenemos claro es que el período para hacer estas innovaciones es la primera mitad del periodo de gestión. ¿El mecanismo de que el contribuyente sea el que hace la declaración y la presenta no va a correr más? No va a correr más. El acto de presentación va a ser consultar la propuesta que le hace la DGI y modificarla en lo que el contribuyente entienda y después enviarlo. Es más, las reliquidaciones, cuando un contribuyente quiera rectificar algo que ya hizo, va a tener que comunicarnos que quiere reliquidar, nos va a enviar su propuesta de reliquidación y nosotros le vamos a dar un feedback a esa propuesta en el momento en que la envíe. ¿Qué pasa con las deudas y los pagos? ¿En qué cosas están pensando? Lo que hay en muchos casos es acumulación de deudas por olvido, porque no se enteraron de que estaban acumulando deudas. La idea es comunicar en forma oportuna y evitar que eso pase, pero tenemos que resolver igualmente todas las deudas acumuladas que tenemos que gestionarlas y cobrarlas. La idea es procurar mecanismos que permitan un pago de esas deudas de forma más consistente con la capacidad de pago. Estamos trabajando en una propuesta de cambio normativo que nos permita, por un lado, tener más cuotas, o sea, tener plazos más largos y tener mecanismos alternativos de retención. Por ejemplo, alguien que tiene deudas en IRPF o en IASS, practicar una retención adicional, obviamente con el consentimiento del contribuyente de un equis por ciento de sus ingresos, algo que el contribuyente considere razonable, y que podamos acordar por un período determinado. Así nos aseguramos el pago de la deuda y en un plazo que seguramente va a ser mayor a la actual, pero va a ser pagable. ¿Sería una retención en el salario de la persona? Claro. Hoy lo que hacen las personas cuando acumulan deudas es suscribir un convenio. Pero a veces el convenio resulta impagable porque acumulan deudas de $ 300, $ 400, $ 500 mil, asalariados o jubilados que no tienen niveles de capacidad de pago como para afrontar eso en el horizonte de 36 meses, que es el máximo que tiene hoy la DGI a través del Código Tributario. La idea es tener plazos mayores (podría ser el doble) y que la cuota de la financiación sea algo asequible. Lo mismo vale para empresas, en la medida en que haya voluntad de pago, procurar opciones que permitan que el negocio siga funcionando. Eso es pensando en un stock acumulado de deudas que hoy existe y que en buena medida, se explica por problemas de olvido, de que tal vez la administración tributaria no ha comunicado oportunamente o lo hizo, pero no lo hizo con la insistencia necesaria. ¿Para eso se precisa hacer un cambio legislativo? Sí, ya estamos trabajando en eso. (N.R: la modificación se prevé incluirla en la próxima ley de Presupuesto quinquenal).  Gustavo Gonzáles, director de la DGI.     Foto: Leonardo Carreño  También tiene la idea de implementar un modelo de servicio basado en oficiales o ejecutivos de cuentas. ¿Cómo funcionaría en la práctica y por qué cree que hay que ir hacia esa modalidad?Seguro la vamos a ensayar. Y estoy casi seguro de que lo que vamos a terminar teniendo es un modelo de servicio con una versión de oficiales o ejecutivos de cuenta, que no hay una sola. Tenemos muchos procesos asociados a distintas obligaciones tributarias y distintas transacciones que realizan los contribuyentes. Esos procesos requieren alta especialización por parte de quienes los ejecutan en DGI. Buena parte de eso ya está automatizado, pero otras partes no. Y eso supone en muchos casos que el contribuyente tenga que estar interactuando con el especialista de ese proceso. En general, no hay una persona que pueda responder por todas esas instancias o situaciones que eventualmente se le puedan presentar a un contribuyente. La idea es tener personas especializadas en interactuar con los contribuyentes, para empezar, y segundo, que esas personas puedan tener una vista informada de todas las situaciones del contribuyente, todos los motivos por los cuales el contribuyente está interactuando con DGI. ¿Es algo más personalizado? Más personalizado y evita tener a los contribuyentes dando vueltas. En pocas palabras es tener a alguien que se haga cargo del contribuyente, que es algo que los propios funcionarios lo señalan como un problema que debemos solucionar. Además, es compatible con otros cambios que están incluidos en el modelo de gestión. Porque de hecho, parte de lo que tenemos que resolver es justamente cómo encastra un modelo de servicio en la gestión del cumplimiento. Las mediciones sobre evasión de impuestos muestran que en IVA es de 20% y en IRAE algo por encima de 40%? ¿Dónde está ese núcleo duro que parece tan difícil de combatir? Hay una combinación de cosas. Es tan multidimensional como lo es en los problemas de cumplimiento. Hay una parte que tiene que ver con lo que veníamos conversando de personas físicas y empresas que por desconocimiento aplican mal o cumplen de manera deficiente con sus obligaciones, como también un tema de una percepción de riesgo que ha ido deteriorándose en estos años. Eso pensando en las grandes masas de contribuyentes. Luego también hay gente que le pone bastante creatividad. Y eso implica también trabajar mucho en inteligencia para identificar situaciones nuevas y demás. Tampoco es que haya habido grandes innovaciones en el sistema tributario que generen nuevas grandes oportunidades, pero sí ha habido modificaciones. La digitalización de las transacciones también es un desafío. La economía se ha bancarizado bastante y cada vez se transa menos en efectivo. Ahí hay una oportunidad porque hay un mayor trackeo de las transacciones, pero venimos atrás. Tenemos que avanzar mucho para llegar a tener el trackeo necesario que nos permita tener una composición más detallada de qué está pasando con la digitalización de las transacciones y el impacto tributario que eso tiene. No hay un motivo, una dimensión o un segmento o un sector que explique. Sí hay sectores que evaden más, otros que evaden menos, hay sectores que tienen más oportunidades de evadir que otros. Por ejemplo, en IRAE los sectores que tienen la oportunidad de hacer exoneraciones por inversión o de acceder a tratamientos tributarios preferenciales por distintas normas del impuesto tienen mayores oportunidades de evasión. En IVA, si parte de tus ventas son de bienes o servicios exentos, también tenés oportunidades de evasión mayores que otras. No quiere decir que vaya, sino que simplemente tiene la oportunidad. Si lo hacen o no es otra historia, pero bueno nosotros eso lo tenemos súper presente. Hay algo que ha evolucionado mucho como la venta de productos y servicios en las redes sociales. ¿Qué acciones están implementando particularmente en eso, en la economía digital? ¿Hay un seguimiento, hay algún plan pensado? Es un foco temático. La forma en cómo estamos organizando esto es primero declarar cuáles son nuestros principales problemas de cumplimiento. Uno de ellos es todo lo que ocurre en economía digital. La idea con cada uno de sus focos es identificar los contribuyentes que componen esa actividad, caracterizarlos, identificar qué oportunidades tienen de evasión, identificar los patrones de comportamiento y después ver las formas en cómo podemos valorar los riesgos de incumplimiento. Una vez que tengamos completada esa caracterización, vamos a empezar a hacer acciones a gran escala. ¿Cuáles? Va a depender de esa caracterización, porque si lo que encontramos es que hay tres o cuatro actores que son muy importantes en toda la cadena, entonces tengo que hacer intervenciones sobre ello. Otra cosa es si encontramos que el problema está muy difuminado, entonces, tenemos que trabajar de otra manera. Ahora, en el ínterin vamos trabajando con acciones más focalizadas que nos permitan, por un lado, ir comunicando los problemas que vamos identificando, mostrando qué es lo que entendemos que se está haciendo mal y cómo debería hacerse, tratando de ayudar también a los contribuyentes. En este tipo de situaciones a veces lo que hay es todo un ambiente de informalidad que en algunos casos trasciende a lo tributario, o sea, es una informalidad que tiene muchos aspectos. Y hay una caracterización que es hasta sociológica que lleva a que la situación sea como es. Probablemente sea más difícil de mover y cambiar situaciones ahí. Hay que ver hasta dónde eso vale la pena o no, porque depende también del nivel de actividad económica, de otro conjunto de caracterizaciones. A veces en realidad saliendo de esos casos más de gente que está como en la línea de flotación, por decirlo de alguna manera, hablando socioeconómicamente, hay problemas de evasión más serios. Y ahí conforme vayamos identificando cuáles son los patrones de comportamiento, de qué manera podemos incidir para cambiar esas situaciones, lo vamos a ir haciendo.  Gustavo Gonzáles, director de la DGI.     Foto: Leonardo Carreño  Durante varios años la DGI envió cartas a contribuyentes cuando detectaba inconsistencias. Allí se mencionaba la posibilidad de ser auditado e incluso la multa a pagar si hubiera evasión. ¿Esa modalidad se va a seguir usando o quedó en el pasado?Eso se hizo con un propósito más de investigación y de evaluación, obviamente con la expectativa de que diera resultados. Es algo que vamos a seguir haciendo. ¿A menor escala que antes? Sí, en la escala que la propia evaluación nos indique que es adecuado hacerlo. Esto de darle información a los contribuyentes tiene un valor importante. Si a vos te marcan qué es lo que tenés que hacer para cumplir y te señalan que si no lo haces tú probabilidad de ser auditado es de, no sé, 33% por decir algo, quiere decir que en uno de cada tres casos como los tuyos, lo van a auditar. No te están diciendo que la probabilidad de que te van a auditar es la misma que te saques el Cinco de Oro, te están diciendo que es muy probable que te vayan a auditar. Si después vos querés correr o no ese riesgo, está en vos. Hay diversas opciones que tienen que ver con cómo gestionamos la conducta de los contribuyentes, que en el mundo han mostrado ser muy eficaces y pasa mucho por lo comunicacional, pero también por dar a conocer. A veces los contribuyentes no saben a qué sanciones se enfrentan si no cumplen, qué es lo que tienen que hacer para cumplir, cuál es la probabilidad de que sean auditados, entender que esa probabilidad no es fija, sino que depende justamente de tu conducta, dar a conocer que su conducta está siendo objeto de seguimiento es algo que vale mucho la pena trabajar y desarrollarlo, porque además se aprende mucho sobre los contribuyentes. Hace algunos años atrás la no aceptación de medios electrónicos en comercios con determinado umbral de ventas anuales implicaba que la DGI pusiera la lupa sobre ellos y era un indicio de riesgo. ¿Eso sigue pasando?Lo seguimos visualizando igual. Tal vez en estos últimos años no se le ha dado tanta comunicación, pero lo seguimos visualizando de la misma manera. Puede haber, y eso se puede entender, algunos casos de personas que se sientan más cómodas trabajando todo en efectivo, sobre todo en emprendimientos muy pequeños, tradicionales, pero cada vez menos. No es algo muy propio de las nuevas generaciones. En la mayoría de los casos, cuando ocurren ese tipo de cosas, o cuando pasa que te ofrecen un descuento si pagás en efectivo o con transferencia respecto de pagar con tarjeta de débito o crédito, no puede haber señal más clara de que casi seguro que lo estás haciendo con la intención de no pagar impuestos. ¿Hay algún sector en particular donde haya más riesgos? Los segmentos que venden a consumo final. Ahí es decisión nuestra de dónde vale más la pena apretar más la cincha por un tema de eficiencia, pero en realidad es algo que hemos visualizado en muchos segmentos de actividad. Y las acciones son proporcionales a la gravedad de la situación. Podrás poner una acción que tenga un propósito, que tenga una característica más coercitiva, podés ponerle más intensidad con presencia física o lo que sea, en situaciones más graves. En otras, capaz que optás por una comunicación, una llamada telefónica, avisos, entablar algún canal de comunicación donde puedas hacer el seguimiento. Pero accionar, siempre se acciona.  ¿Cuál es la meta de recaudación para el año? No está cerrado. Obviamente que la meta se va a definir y va a ser importante. En un escenario de restricción fiscal severa como el que estamos avizorando, obviamente que cada peso cuenta. Lo que sí está claro más allá de la meta puntual del 2025, es que todo esto que estamos haciendo tiene que ser compatible, y así estamos buscando que sea, con mejoras significativas en la recaudación, derivadas de disminuciones de la evasión. Esa va a ser una de las fuentes más relevantes de mejora del presupuesto público. Lo que tenemos que hacer es buscar mejoras sostenidas, no ganancias de corto plazo, sino procurar cambios de conducta que sean permanentes en los contribuyentes de tal manera que nos lleven a un estándar de cumplimiento más alto. Perfil  Gustavo González es Licenciado en Economía por la Universidad de la República de Uruguay.  Trabajó durante 14 años en la Dirección General Impositiva y se desempeñó en áreas de análisis económico de diseños tributarios y análisis de riesgos de cumplimiento tributario, entre otros.  Además, ha trabajado como experto para el Fondo Monetario Internacional, el Banco Mundial y el BID en administraciones tributarias de más de 10 países. También fue docente durante 20 años en la Universidad de la República.</p>
        </div>
        <br><br><br>
            <div style="display: none;">
                <label for="voiceSelect">Seleccionar voz:</label>
                <select id="voiceSelect"></select>
            </div>
            <div class="controls">
                <button onclick="startReading()" id="playButton">
                    🔊 Leer
                </button>
                <button onclick="pauseReading()" id="pauseButton" disabled style="display: none;">
                    ⏸️ Pausar
                </button>
                <button onclick="resumeReading()" id="resumeButton" disabled style="display: none;">
                    ▶️ Continuar
                </button>
                <button onclick="stopReading()" id="stopButton" disabled>
                    ⏹️ Detener
                </button>
            </div>
            <div id="progress" style="display: none;"></div>
        <br><br><br>
        <button class="btnL" onclick="compartir()">Compartir</button>
        <br><br><br>
        <button class="btnL" onclick="window.location.href='https://www.elobservador.com.uy/economia-y-empresas/pago-impuestos-los-planes-la-dgi-que-buscan-facilitarle-al-contribuyente-y-tambien-marcarle-la-cancha-n6004426'">Ver en web original</button>
        <br><br><br>
        <!-- <button class="btnL" onclick="window.location.href='https://matenews.github.io/MateNews/'">Volver a la página principal</button>
        <br><br><br> -->


        <script>
            function compartir() {
            if (navigator.share) {
                navigator.share({
                title: ' Pago de impuestos: los planes de la DGI que buscan facilitarle al contribuyente y también marcarle la cancha', // Opcional, pero recomendado     
                text: ' Pago de impuestos: los planes de la DGI que buscan facilitarle al contribuyente y también marcarle la cancha',  // Opcional
                url: 'https://www.elobservador.com.uy/economia-y-empresas/pago-impuestos-los-planes-la-dgi-que-buscan-facilitarle-al-contribuyente-y-tambien-marcarle-la-cancha-n6004426'
                })
                .then(() => console.log('Contenido compartido exitosamente'))
                .catch((error) => console.error('Error al compartir:', error));
            } else {
                // Código alternativo si la API Web Share no está disponible
                console.log("Web Share API no soportada");
                // Puedes usar aquí la opción 2 (botones personalizados con JavaScript) de mi respuesta anterior
            }
            }
        </script>


        <script>
            let speechSynthesis = window.speechSynthesis;
            let currentUtterance = null;
            let isPaused = false;
            let isReading = false;
            let textBlocks = [];
            let currentBlockIndex = 0;
            let lastSpokenIndex = 0;
            const BLOCK_SIZE = 800;

            function updateButtons(speaking) {
                document.getElementById('playButton').disabled = speaking;
                document.getElementById('pauseButton').disabled = !speaking;
                document.getElementById('resumeButton').disabled = !isPaused;
                document.getElementById('stopButton').disabled = !speaking;
            }

            function updateProgress() {
                const progressDiv = document.getElementById('progress');
                if (isReading) {
                    progressDiv.textContent = `Leyendo bloque ${currentBlockIndex + 1} de ${textBlocks.length}`;
                } else {
                    progressDiv.textContent = '';
                }
            }

            function splitIntoBlocks(text) {
                // Dividir el texto en oraciones usando puntuación común
                const sentences = text.replace(/([.!?])\s+/g, "$1|").split("|");

                let blocks = [];
                let currentBlock = '';

                sentences.forEach(sentence => {
                    // Si la oración es muy larga, dividirla en la coma más cercana al BLOCK_SIZE
                    if (sentence.length > BLOCK_SIZE) {
                        let subSentences = sentence.replace(/,\s+/g, ",|").split("|");
                        subSentences.forEach(subSentence => {
                            if (currentBlock.length + subSentence.length > BLOCK_SIZE) {
                                if (currentBlock) blocks.push(currentBlock.trim());
                                currentBlock = subSentence;
                            } else {
                                currentBlock += (currentBlock ? ' ' : '') + subSentence;
                            }
                        });
                    } else {
                        if (currentBlock.length + sentence.length > BLOCK_SIZE) {
                            blocks.push(currentBlock.trim());
                            currentBlock = sentence;
                        } else {
                            currentBlock += (currentBlock ? ' ' : '') + sentence;
                        }
                    }
                });

                if (currentBlock) blocks.push(currentBlock.trim());
                return blocks;
            }

            function speakBlock(index) {
                if (index >= textBlocks.length) {
                    isReading = false;
                    updateButtons(false);
                    updateProgress();
                    return;
                }

                currentUtterance = new SpeechSynthesisUtterance(textBlocks[index]);
                currentUtterance.rate = parseFloat(1.3);
                lastSpokenIndex = index;


                currentUtterance.onend = function() {
                    if (isReading && !isPaused) {
                        currentBlockIndex++;
                        updateProgress();
                        speakBlock(currentBlockIndex);
                    }
                };

                currentUtterance.onerror = function(event) {
                    console.error('Error en la lectura:', event);
                    isReading = false;
                    updateButtons(false);
                    updateProgress();
                };

                speechSynthesis.speak(currentUtterance);
            }

            function startReading() {
                const text = document.getElementById('texto').innerText;
                if (!text) return;

                // Detener cualquier lectura previa
                stop();

                // Preparar nueva lectura
                textBlocks = splitIntoBlocks(text);
                currentBlockIndex = 0;
                isReading = true;
                isPaused = false;

                updateButtons(true);
                updateProgress();
                speakBlock(currentBlockIndex);
            }

            function pause() {
                speechSynthesis.pause();
                isPaused = true;
                updateButtons(true);
            }

            function resume() {
                speechSynthesis.resume();
                isPaused = false;
                updateButtons(true);
            }

            function stop() {
                speechSynthesis.cancel();
                isReading = false;
                isPaused = false;
                currentBlockIndex = 0;
                updateButtons(false);
                updateProgress();
            }

            function pauseReading() {
                if (!isReading) return;

                speechSynthesis.pause();
                isPaused = true;
                isReading = false;
                updateButtons(true);
                updateProgress();
            }

            function resumeReading() {
                if (!isPaused) return;

                isPaused = false;
                isReading = true;

                // Si el utterance actual ya terminó, comenzar con el siguiente bloque
                if (lastSpokenIndex === currentBlockIndex) {
                    currentBlockIndex++;
                }

                updateButtons(true);
                updateProgress();

                // Si hay un utterance pausado, resumirlo
                if (speechSynthesis.paused) {
                    speechSynthesis.resume();
                } else {
                    // Si no hay utterance pausado, comenzar desde el bloque actual
                    speakBlock(currentBlockIndex);
                }
            }

            function stopReading() {
                speechSynthesis.cancel();
                finishReading();
            }

            function finishReading() {
                isReading = false;
                isPaused = false;
                currentBlockIndex = 0;
                lastSpokenIndex = -1;
                currentUtterance = null;
                updateButtons(false);
                updateProgress();
            }

        </script>        

        <script>

            var elem = document.documentElement;
            var fullscreenButton = document.getElementById("fullscreenButton");
            var fullscreenIcon = document.getElementById("fullscreenIcon");

            fullscreenButton.addEventListener("click", function() {
            if (document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement || document.msFullscreenElement) {
                if (document.exitFullscreen) {
                document.exitFullscreen();
                } else if (document.mozCancelFullScreen) { /* Firefox */
                document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */
                document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) { /* IE/Edge */
                document.msExitFullscreen();
                }
            } else {
                if (elem.requestFullscreen) {
                elem.requestFullscreen();
                } else if (elem.mozRequestFullScreen) { /* Firefox */
                elem.mozRequestFullScreen();
                } else if (elem.webkitRequestFullscreen) { /* Chrome, Safari and Opera */
                elem.webkitRequestFullscreen();
                } else if (elem.msRequestFullscreen) { /* IE/Edge */
                elem.msRequestFullscreen();
                }
            }
            });

            document.addEventListener('fullscreenchange', (event) => {
            if (!document.fullscreenElement) {
                fullscreenIcon.innerHTML = '<path d="M5 5h5v5H5zM14 5h5v5h-5zM5 14h5v5H5zM14 14h5v5h-5z"/>';
            } else {
                fullscreenIcon.innerHTML = '<path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>';
            }
            });
        </script>

    </body>
    </html>